// Get references to the HTML elements
const openChatBtn = document.getElementById("open-chat-button");
const closeChatBtn = document.getElementById("close-chat-button");
const chatContainer = document.getElementById("chat-container");
const chatWindow = document.getElementById("chat-window");
const chatInput = document.getElementById("chat-input");
const sendButton = document.getElementById("send-button");

// --- Event Listeners for Opening and Closing the Chat ---
openChatBtn.addEventListener("click", () => {
  chatContainer.classList.remove("hidden");
});

closeChatBtn.addEventListener("click", () => {
  chatContainer.classList.add("hidden");
});

// --- Enhanced Chatbot Logic ---
function appendMessage(message, sender) {
  const messageElement = document.createElement("div");
  messageElement.classList.add("message");
  messageElement.classList.add(
    sender === "user" ? "user-message" : "bot-message"
  );

  // Check if message contains a URL to make it clickable
  if (message.includes("https://")) {
    const urlParts = message.split("https://");
    const beforeUrl = urlParts[0];
    const url = "https://" + urlParts[1];
    messageElement.innerHTML = `${beforeUrl}<a href="${url}" target="_blank" style="color: #007bff; text-decoration: underline;">${url}</a>`;
  } else {
    messageElement.textContent = message;
  }

  chatWindow.appendChild(messageElement);
  chatWindow.scrollTop = chatWindow.scrollHeight;
}

function sendMessage() {
  const userMessage = chatInput.value.trim();
  if (userMessage === "") {
    return;
  }

  appendMessage(userMessage, "user");
  chatInput.value = "";

  // Show typing indicator
  const typingIndicator = document.createElement("div");
  typingIndicator.classList.add("message", "bot-message", "typing");
  typingIndicator.textContent = "Typing...";
  chatWindow.appendChild(typingIndicator);
  chatWindow.scrollTop = chatWindow.scrollHeight;

  setTimeout(() => {
    chatWindow.removeChild(typingIndicator);
    const botResponse = getBotResponse(userMessage);
    appendMessage(botResponse, "bot");
  }, 1000);
}

function getBotResponse(input) {
  const lowerInput = input.toLowerCase();

  // === GREETINGS & BASIC INFO ===
  if (
    lowerInput.includes("hello") ||
    lowerInput.includes("hi") ||
    lowerInput.includes("hey")
  ) {
    return "Hello! Welcome to Elite Marketing Technology. How can I assist you today? You can ask about our services, pricing, company info, careers, or book a free consultation!";
  } else if (lowerInput.includes("how are you")) {
    return "I'm doing great! Ready to help you with all your digital marketing and IT needs. What would you like to know about our services?";
  } else if (lowerInput.includes("thank")) {
    return "You're welcome! Is there anything else I can help you with regarding our digital marketing services?";
  } else if (lowerInput.includes("bye") || lowerInput.includes("goodbye")) {
    return "Thank you for chatting with Elite Marketing! Have a great day and feel free to reach out anytime for your digital marketing needs.";

    // === COMPANY INFORMATION ===
  } else if (
    lowerInput.includes("about") ||
    lowerInput.includes("company") ||
    lowerInput.includes("elite marketing")
  ) {
    return "Elite Marketing Technology is a full-service digital marketing and development agency based in Bahria Town Phase 4, Rawalpindi. We specialize in Digital Marketing, SEO, Website Development, and Branding Solutions for local and international clients. We have 110+ happy clients and 300+ successful projects completed by our team of 20+ creative professionals!";
  } else if (lowerInput.includes("mission") || lowerInput.includes("vision")) {
    return "Our mission is to empower businesses with smart, innovative, and performance-driven marketing and technology solutions that transform ideas into impact and growth into success. Our vision is to create a future where every brand has the tools needed to thrive in the digital landscape.";
  } else if (
    lowerInput.includes("location") ||
    lowerInput.includes("address") ||
    lowerInput.includes("where") ||
    lowerInput.includes("map") ||
    lowerInput.includes("google map")
  ) {
    return "üìç We are located at: Plot 26,27 Second floor, 4 Corniche Road, Phase 4 Bahria Town, Rawalpindi, 46220\n\nüì± Phone: +92 320 5019342\nüìß Email: info@elitemarketingtechnology.com\n\nüó∫Ô∏è Google Maps Location: https://maps.app.goo.gl/nTzo8p9pgLwPS1Cv9\n\nClick the link above to open our location in Google Maps!";
  } else if (
    lowerInput.includes("experience") ||
    lowerInput.includes("years") ||
    lowerInput.includes("established")
  ) {
    return "We have 3+ years of experience serving 110+ happy clients with 300+ successful projects completed by our team of 20+ creative professionals. Our track record speaks for itself!";
  } else if (
    lowerInput.includes("team") ||
    lowerInput.includes("staff") ||
    lowerInput.includes("people")
  ) {
    return "We have a talented team of 20+ creative minds including digital strategists, web developers, SEO experts, graphic designers, and social media specialists working together to deliver exceptional results.";

    // === SERVICES - GENERAL ===
  } else if (
    lowerInput.includes("service") ||
    lowerInput.includes("what do you offer") ||
    lowerInput.includes("what can you do") ||
    lowerInput.includes("offer")
  ) {
    return "We offer comprehensive digital solutions:\n\n‚Ä¢ üåê Website Development & Design\n‚Ä¢ üì± Social Media Marketing\n‚Ä¢ üîç Search Engine Optimization (SEO)\n‚Ä¢ üì≤ Application Development\n‚Ä¢ ‚öñÔ∏è Business Setup & Legal Compliance\n‚Ä¢ üéØ All-in-One Business Solutions\n‚Ä¢ üõ°Ô∏è IT Consulting & Cybersecurity\n\nWhich service would you like more details about?";

    // === WEBSITE DEVELOPMENT ===
  } else if (
    lowerInput.includes("website") ||
    lowerInput.includes("web development") ||
    lowerInput.includes("web design")
  ) {
    if (
      lowerInput.includes("price") ||
      lowerInput.includes("cost") ||
      lowerInput.includes("package")
    ) {
      return "üíª Website Development Packages:\n\n‚Ä¢ Static Basic: CAD 700 (5 pages, responsive design)\n‚Ä¢ Static Advanced: CAD 1300 (10 pages, advanced features)\n‚Ä¢ WordPress Basic: CAD 1000 (5 pages, theme customization)\n‚Ä¢ WordPress Advanced: CAD 2500 (15 pages, premium features)\n‚Ä¢ E-commerce: CAD 3000 (up to 50 products)\n\nüõ†Ô∏è Website Care Packages:\n‚Ä¢ Basic: CAD 100/month\n‚Ä¢ Standard: CAD 200/month  \n‚Ä¢ Premium: CAD 400/month\n\nAll packages include responsive design and basic SEO!";
    } else if (
      lowerInput.includes("how long") ||
      lowerInput.includes("time") ||
      lowerInput.includes("duration")
    ) {
      return "‚è±Ô∏è Website Development Timelines:\n‚Ä¢ Static websites: 2-3 weeks\n‚Ä¢ WordPress sites: 2-4 weeks\n‚Ä¢ E-commerce sites: 5 weeks\n\nExact timing depends on project complexity. We provide detailed timelines during our free consultation!";
    } else if (
      lowerInput.includes("portfolio") ||
      lowerInput.includes("example") ||
      lowerInput.includes("work")
    ) {
      return "We have completed 50+ web projects for various industries! Our portfolio includes business websites, e-commerce stores, web applications, and custom portals. Would you like to see some examples during a consultation?";
    } else {
      return "üåê We provide complete website development services:\n‚Ä¢ Custom Website Development\n‚Ä¢ Responsive Design (mobile-friendly)\n‚Ä¢ E-commerce Solutions\n‚Ä¢ WordPress Development\n‚Ä¢ Website Maintenance & Support\n‚Ä¢ Website Optimization\n\nAll our websites are SEO-optimized and designed to convert visitors into customers!";
    }

    // === SOCIAL MEDIA MARKETING ===
  } else if (
    lowerInput.includes("social media") ||
    lowerInput.includes("smm") ||
    lowerInput.includes("facebook") ||
    lowerInput.includes("instagram") ||
    lowerInput.includes("tiktok") ||
    lowerInput.includes("linkedin")
  ) {
    if (
      lowerInput.includes("price") ||
      lowerInput.includes("cost") ||
      lowerInput.includes("package")
    ) {
      return "üì± Social Media Marketing Packages:\n\n‚Ä¢ STARTER: CAD 450/month (15 posts, 2 reels/week)\n‚Ä¢ GROWTH: CAD 650/month (25 posts, 3 reels/week)  \n‚Ä¢ SCALE: CAD 950/month (30 posts, 5 reels/week)\n\nüéØ Advertising Packages:\n‚Ä¢ Google Ads: CAD 500-2000/month\n‚Ä¢ Meta Ads: CAD 500-2000/month\n\nAll packages include custom graphics and performance reporting!";
    } else if (
      lowerInput.includes("result") ||
      lowerInput.includes("success") ||
      lowerInput.includes("roi")
    ) {
      return "We have managed 50+ successful SMM projects! Our clients typically see increased engagement, higher brand awareness, and qualified lead generation. We provide monthly analytics reports to track your ROI.";
    } else {
      return "üì± Our Social Media Marketing services include:\n‚Ä¢ Content Creation & Branding\n‚Ä¢ Social Media Strategy Development\n‚Ä¢ Paid Advertising (Facebook, Instagram, LinkedIn, TikTok)\n‚Ä¢ Page & Profile Optimization\n‚Ä¢ Analytics & Performance Reporting\n‚Ä¢ Community Management\n\nWe help you engage, influence, and convert your audience!";
    }

    // === SEO SERVICES ===
  } else if (
    lowerInput.includes("seo") ||
    lowerInput.includes("search engine") ||
    lowerInput.includes("google ranking") ||
    lowerInput.includes("organic")
  ) {
    if (lowerInput.includes("price") || lowerInput.includes("cost")) {
      return "üîç SEO services are customized based on your industry and competition level. We offer monthly SEO packages starting from CAD 500. During our free consultation, we analyze your needs and provide a tailored quote.";
    } else {
      return "üîç We provide comprehensive SEO services:\n‚Ä¢ On-page SEO Optimization\n‚Ä¢ Technical SEO Audits\n‚Ä¢ Content Marketing Strategy\n‚Ä¢ Link Building Campaigns\n‚Ä¢ Local SEO Optimization\n‚Ä¢ Monthly Performance Reports\n\nWe help you climb Google rankings and reach the right audience!";
    }

    // === APP DEVELOPMENT ===
  } else if (
    lowerInput.includes("app") ||
    lowerInput.includes("application") ||
    lowerInput.includes("mobile") ||
    lowerInput.includes("ios") ||
    lowerInput.includes("android")
  ) {
    return "üì± We develop powerful mobile applications for both Android and iOS platforms. Our app development services include:\n‚Ä¢ Custom Mobile App Development\n‚Ä¢ UI/UX Design\n‚Ä¢ App Store Optimization\n‚Ä¢ Ongoing Maintenance & Updates\n‚Ä¢ Cross-platform Development\n\nWe build secure, scalable, and user-friendly apps that grow with your business!";

    // === BUSINESS SETUP ===
  } else if (
    lowerInput.includes("business setup") ||
    lowerInput.includes("legal") ||
    lowerInput.includes("compliance") ||
    lowerInput.includes("registration") ||
    lowerInput.includes("incorporation")
  ) {
    return "‚öñÔ∏è We provide complete business setup services in Pakistan:\n‚Ä¢ Company Registration & Incorporation\n‚Ä¢ Tax Registration & Compliance\n‚Ä¢ Legal Structure Setup\n‚Ä¢ Business License Assistance\n‚Ä¢ Ongoing Compliance Support\n\nSmart business starts with the right foundation!";

    // === ALL-IN-ONE SOLUTIONS ===
  } else if (
    lowerInput.includes("all in one") ||
    lowerInput.includes("complete") ||
    lowerInput.includes("package") ||
    lowerInput.includes("comprehensive")
  ) {
    return "üéØ Our All-in-One Business Solutions cover everything you need:\n‚Ä¢ Website Development\n‚Ä¢ Mobile App Creation\n‚Ä¢ Digital Marketing\n‚Ä¢ SEO Services\n‚Ä¢ Business Setup\n‚Ä¢ Ongoing Support\n\nPerfect for businesses that want everything under one roof for seamless growth!";

    // === CONTACT & CONSULTATION ===
  } else if (
    lowerInput.includes("contact") ||
    lowerInput.includes("call") ||
    lowerInput.includes("email") ||
    lowerInput.includes("number") ||
    lowerInput.includes("phone")
  ) {
    return "üìû Contact Elite Marketing:\n\n‚Ä¢ Phone: +92 320 5019342\n‚Ä¢ Email: info@elitemarketingtechnology.com\n‚Ä¢ Address: Plot 26,27 Second floor, 4 Corniche Road, Phase 4 Bahria Town, Rawalpindi\n‚Ä¢ Google Maps: https://maps.app.goo.gl/nTzo8p9pgLwPS1Cv9\n\nWe're available Monday to Friday, 9AM to 6PM!";
  } else if (
    lowerInput.includes("consultation") ||
    lowerInput.includes("free") ||
    lowerInput.includes("meeting") ||
    lowerInput.includes("discuss") ||
    lowerInput.includes("talk")
  ) {
    return "üéØ We offer FREE initial consultations! During our meeting, we'll:\n‚Ä¢ Understand your business goals\n‚Ä¢ Analyze your current digital presence\n‚Ä¢ Provide strategic recommendations\n‚Ä¢ Discuss pricing and timelines\n‚Ä¢ Answer all your questions\n\nShall I connect you with our team to schedule your free consultation?";
  } else if (
    lowerInput.includes("quote") ||
    lowerInput.includes("pricing") ||
    lowerInput.includes("get started")
  ) {
    return "üíº To get a detailed quote, we recommend booking a free consultation. This allows us to understand your specific needs and provide accurate pricing. Would you like me to explain our general pricing structure or connect you with our sales team?";

    // === CAREERS ===
  } else if (
    lowerInput.includes("career") ||
    lowerInput.includes("job") ||
    lowerInput.includes("hire") ||
    lowerInput.includes("work") ||
    lowerInput.includes("vacancy") ||
    lowerInput.includes("position")
  ) {
    return "üíº We're always looking for talented individuals! Current opportunities may include:\n‚Ä¢ Web Developers (HTML, CSS, JavaScript)\n‚Ä¢ Graphic Designers (Figma, Adobe Suite)\n‚Ä¢ Digital Marketing Specialists\n‚Ä¢ SEO Experts\n\nPlease check our Careers page for current openings or send your resume to info@elitemarketingtechnology.com";

    // === PROCESS & WORKFLOW ===
  } else if (
    lowerInput.includes("process") ||
    lowerInput.includes("work") ||
    lowerInput.includes("how do you work") ||
    lowerInput.includes("workflow")
  ) {
    return "üîÑ Our 8-step work process:\n\n1. Customer Query - We understand your needs\n2. Initial Meeting - Discuss project details\n3. Quotation - Transparent pricing\n4. Detailed Analysis - In-depth requirement study\n5. Invoices - Clear financial documentation\n6. Strategy & Roadmap - Actionable plan\n7. Onboarding Call - Smooth project kickoff\n8. Let's Work Together - Collaborative execution\n\nWe ensure clear communication at every step!";

    // === SUCCESS METRICS ===
  } else if (
    lowerInput.includes("client") ||
    lowerInput.includes("success") ||
    lowerInput.includes("project") ||
    lowerInput.includes("portfolio")
  ) {
    return "üìä Our Success Metrics:\n‚Ä¢ 110+ Happy Clients\n‚Ä¢ 300+ Successful Projects\n‚Ä¢ 50+ Web Development Projects\n‚Ä¢ 50+ Social Media Projects\n‚Ä¢ 20+ Creative Team Members\n‚Ä¢ 3+ Years of Experience\n\nWe have a proven track record of delivering results!";

    // === INDUSTRY SPECIFIC ===
  } else if (
    lowerInput.includes("industry") ||
    lowerInput.includes("sector") ||
    lowerInput.includes("niche")
  ) {
    return "We serve clients across various industries including:\n‚Ä¢ E-commerce & Retail\n‚Ä¢ Healthcare & Medical\n‚Ä¢ Real Estate\n‚Ä¢ Education\n‚Ä¢ Technology\n‚Ä¢ Hospitality\n‚Ä¢ Professional Services\n\nOur strategies are tailored to your specific industry needs!";

    // === URGENT REQUESTS ===
  } else if (
    lowerInput.includes("urgent") ||
    lowerInput.includes("emergency") ||
    lowerInput.includes("asap") ||
    lowerInput.includes("immediately")
  ) {
    return 'üö® For urgent inquiries, please call us directly at +92 320 5019342 or email info@elitemarketingtechnology.com with "URGENT" in the subject line. Our team will prioritize your request!';

    // === TECHNICAL SUPPORT ===
  } else if (
    lowerInput.includes("support") ||
    lowerInput.includes("help") ||
    lowerInput.includes("problem") ||
    lowerInput.includes("issue")
  ) {
    return "üîß For technical support or existing client inquiries, please contact our support team at info@elitemarketingtechnology.com or call +92 320 5019342. We offer various support packages to meet your needs.";

    // === PRICING & COST ===
  } else if (
    lowerInput.includes("price") ||
    lowerInput.includes("cost") ||
    lowerInput.includes("how much") ||
    lowerInput.includes("budget")
  ) {
    return "üí∞ Our pricing varies by service:\n\n‚Ä¢ Website Development: CAD 700-3000\n‚Ä¢ Social Media Marketing: CAD 450-950/month\n‚Ä¢ SEO: Starting from CAD 500/month\n‚Ä¢ App Development: Custom quotes\n‚Ä¢ Business Setup: Custom packages\n\nAll services can be customized to fit your budget!";

    // === HELP & SUPPORT ===
  } else if (lowerInput.includes("help")) {
    return "üÜò I can help you with information about:\n\n‚Ä¢ Our Services & Pricing\n‚Ä¢ Company Information & Location\n‚Ä¢ Contact Details & Free Consultations\n‚Ä¢ Career Opportunities\n‚Ä¢ Our Work Process & Portfolio\n‚Ä¢ Industry-specific Solutions\n\nWhat would you like to know more about?";

    // === DEFAULT RESPONSE ===
  } else {
    return "I'm not sure I understand. At Elite Marketing Technology, we specialize in digital marketing, website development, SEO, app development, and business solutions. You can ask about:\n\n‚Ä¢ Our services and pricing\n‚Ä¢ Company information\n‚Ä¢ Booking a free consultation\n‚Ä¢ Career opportunities\n‚Ä¢ Or type 'help' for more options!";
  }
}

// Event listeners for sending messages
sendButton.addEventListener("click", sendMessage);

chatInput.addEventListener("keypress", (event) => {
  if (event.key === "Enter") {
    sendMessage();
  }
});

// Add initial welcome message when chat opens
openChatBtn.addEventListener("click", () => {
  // Only add welcome message if chat is empty
  if (chatWindow.children.length === 0) {
    setTimeout(() => {
      appendMessage(
        "Hello! I'm your Elite Marketing Technology assistant. I can help you with information about our services, pricing, company details, careers, and more. How can I assist you today?",
        "bot"
      );
    }, 500);
  }
});

// Add touch support for mobile devices
document.addEventListener("touchstart", function () {}, { passive: true });
